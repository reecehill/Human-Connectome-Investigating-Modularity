"""
This type stub file was generated by pyright.
"""

"""
This module contains pipelines and functions for generating t1, t2 and
t2star qMRI maps.

Author: Himanshu Aggarwal (himanshu.aggarwal@inria.fr), 2021-22
"""
def closing(image, iterations):
    """ Wrapper for scipy's binary_closing function to close a NIFTI image with
    n iterations
    
    Parameters
    ----------
    image : nibabel.nifti1.Nifti1Image
        NIFTI image to be closed loaded as a nibabel Nifti1Image object
    iterations : int
        number or closing iterations to perform on the input image

    Returns
    -------
    nibabel.nifti1.Nifti1Image
        NIFTI image with given iterations of closing on it
    """
    ...

def to_T2space(t2_img, t1_img, output_dir):
    """ Wrapper for pypreprocess's coregister function, used in T2 pipeline to
    coregister T1 image to T2 image 

    Parameters
    ----------
    t2_img : str
        path for the t2 image
    t1_img : str
        path for the t1 image
    output_dir : str
        location to write the corregistered image

    Returns
    -------
    coreged : pypreprocess.nipype_preproc_spm_utils.Subject_Data
        dict-like object containing information about preprocessing, input and
        output file locations which are used later in the pipelines
    """
    ...

def to_MNI(image, data=..., func=...):
    """ Wrapper for pypreprocess's normalize function, to transform images from
    subject space to MNI-152 space

    Parameters
    ----------
    image : str
        path for the t1 image
    data : pypreprocess.nipype_preproc_spm_utils.Subject_Data, optional
        dict-like object containing information about preprocessing, input and
        output file locations, by default SubjectData()
    func : str, optional
        path to another low-resolution(?) image to be normalised alongwith the
        anatomical image. Used in t1_pipeline to normalise B1 map as functional
        image with T1 map as anatomical, by default None

    Returns
    -------
    normalized : pypreprocess.nipype_preproc_spm_utils.Subject_Data
        dict-like object containing information about preprocessing, input and
        output file locations which are used later in the pipelines
    """
    ...

def segment(image, normalize):
    """ Wrapper for pypreprocess's segment function, to segment images into
    grey matter, white matter and csf

    Parameters
    ----------
    image : str
        path for the nifti image
    normalize : bool
        whether or not to normalize the segments

    Returns
    -------
    segmented : pypreprocess.nipype_preproc_spm_utils.Subject_Data
        dict-like object containing information about preprocessing, input and
        output file locations which are used later in the pipelines
    """
    ...

def plot_thresholded_qmap(img, coords, output_folder, thresh=..., map=..., interactive=...): # -> None:
    """ Plot the final estimated t1 or t2-maps and threshold voxel intensity at
    a given percentile or a given arbitrary intensity

    Parameters
    ----------
    img : str
        path to the nifti image
    coords : tuple
        a tuple of size 3, specifying the slice to view
    output_folder : str
        location to save the plots
    thresh : str or int, optional
        if str then thresholds image at that many percentile and if int then
        thresholds the image at that intensity, by default 99
    map : str, optional
        specify what map is it (eg. t1 or t2) just used in file name strings of
        the plot, by default "map"
    interactive : bool, optional
        whether or not to plot the interactive html plots, by default False
    """
    ...

def t2_pipeline(closing_iter=..., do_coreg=..., do_normalise_before=..., do_segment=..., do_normalise_after=..., do_plot=..., keep_tmp=..., sub_name=..., sess_num=..., root_path=...):
    """ Preprocess qMRI t2 images and then run estimation to generate t2-maps,
    more details in scripts/qmri_README.md, only one of do_normalise_before and
    do_normalise_after should be True, both can be False

    Parameters
    ----------
    closing_iter : int, optional
        number of closing iteration for creating a suitable mask, by default 12
    do_coreg : bool, optional
        whether or not to corregister t1 image to t2 image-space. The t1 image
        is later used to create a mask for t2 map estimation step because 
        t1 image being high-res gives a better mask than t2 itself,
        by default True
    do_normalise_before : bool, optional
        whether or not to normalise BEFORE estimation. So if True the input
        image is transformed to MNI152 space. Make it True only if 
        do_normalise_after is False and vice versa. Also, normalising before the
        estimation is recommended over doing it after - it has been observed to
        give better looking results for IBC subjects, by default False
    do_segment : bool, optional
        whether or not to segment the image. The segments are used to create a
        mask used to exclude skull and neck during estimation. So if False,
        estimation is done on every voxel in the input image, by default True
    do_normalise_after : bool, optional
        whether or not to normalise AFTER estimation. So if True the estimated
        map is transformed to MNI152 space. Make it True only if 
        do_normalise_before is False and vice versa. But normalising the 
        estimated map has been observed to give spurious results for IBC
        subjects, by default False
    do_plot : bool, optional
        whether or not to create thresholded plots for the images. Included 
        because the actual output nifti images have unrealistically high 
        intensity voxels as a result of inversion and they need to be discarded
        for viewing the images, by default True
    keep_tmp : bool, optional
        whether or not to keep temporary transitional images created during
        various preprocessing steps. Stored in a separate drectory for each
        pipeline under output directory, by default True
    sub_name : str, optional
        name of the input subject, by default 'sub-11'
    sess_num : str, optional
        name of the session for relaxometry acquisition, by default 'ses-17'
    root_path : str, optional
        path to the root directory where directory named sourcedata should have
        input files and a directory named derivatives where the outputs would be
        stored, by default '/neurospin/ibc'
    """
    ...

def t1_pipeline(closing_iter=..., do_normalise_before=..., do_segment=..., do_normalise_after=..., do_plot=..., keep_tmp=..., sub_name=..., sess_num=..., root_path=...):
    """ Preprocess qMRI t1 images and then run estimation to generate t1-maps,
    more details in scripts/qmri_README.md, only one of do_normalise_before
    and do_normalise_after should be True, both can be False

    Parameters
    ----------
    closing_iter : int, optional
        number of closing iteration for creating a suitable mask, by default 12
    do_normalise_before : bool, optional
        whether or not to normalise BEFORE estimation. So if True the input
        image is transformed to MNI152 space. Make it True only if 
        do_normalise_after is False and vice versa. Also, normalising before the
        estimation is recommended over doing it after - it has been observed to
        give better looking results for IBC subjects, by default False
    do_segment : bool, optional
        whether or not to segment the image. The segments are used to create a
        mask used to exclude skull and neck during estimation. So if False,
        estimation is done on every voxel in the input image, by default True
    do_normalise_after : bool, optional
        whether or not to normalise AFTER estimation. So if True the estimated
        map is transformed to MNI152 space. Make it True only if 
        do_normalise_before is False and vice versa. But normalising the 
        estimated map has been observed to give spurious results for IBC
        subjects, by default False
    do_plot : bool, optional
        whether or not to create thresholded plots for the images. Included 
        because the actual output nifti images have unrealistically high 
        intensity voxels as a result of inversion and they need to be discarded
        for viewing the images, by default True
    keep_tmp : bool, optional
        whether or not to keep temporary transitional images created during
        various preprocessing steps. Stored in a separate drectory for each
        pipeline under output directory, by default True
    sub_name : str, optional
        name of the input subject, by default 'sub-11'
    sess_num : str, optional
        name of the session for relaxometry acquisition, by default 'ses-17'
    root_path : str, optional
        path to the root directory where directory named sourcedata should have
        input files and a directory named derivatives where the outputs would be
        stored, by default '/neurospin/ibc'
    """
    ...

def t2star_pipeline(closing_iter=..., do_normalise_before=..., do_segment=..., do_normalise_after=..., do_plot=..., keep_tmp=..., sub_name=..., sess_num=..., root_path=..., echo_times=...): # -> Literal[1]:
    """ Preprocess qMRI t2 star images and then run estimation to generate
    t2star-maps, more details in scripts/qmri_README.md, only one of 
    do_normalise_before and do_normalise_after should be True, both can be False

    Parameters
    ----------
    closing_iter : int, optional
        number of closing iteration for creating a suitable mask, by default 12
    do_normalise_before : bool, optional
        whether or not to normalise BEFORE estimation. So if True the input
        image is transformed to MNI152 space. Make it True only if 
        do_normalise_after is False and vice versa. Also, normalising before the
        estimation is recommended over doing it after - it has been observed to
        give better looking results for IBC subjects, by default False
    do_segment : bool, optional
        whether or not to segment the image. The segments are used to create a
        mask used to exclude skull and neck during estimation. So if False,
        estimation is done on every voxel in the input image, by default True
    do_normalise_after : bool, optional
        whether or not to normalise AFTER estimation. So if True the estimated
        map is transformed to MNI152 space. Make it True only if 
        do_normalise_before is False and vice versa. But normalising the 
        estimated map has been observed to give spurious results for IBC
        subjects. Not implemented for t2star processing, by default False
    do_plot : bool, optional
        whether or not to create thresholded plots for the images. Included 
        because the actual output nifti images have unrealistically high 
        intensity voxels as a result of inversion and they need to be discarded
        for viewing the images, by default True
    keep_tmp : bool, optional
        whether or not to keep temporary transitional images created during
        various preprocessing steps. Stored in a separate drectory for each
        pipeline under output directory, by default True
    sub_name : str, optional
        name of the input subject, by default 'sub-11'
    sess_num : str, optional
        name of the session for relaxometry acquisition, by default 'ses-17'
    root_path : str, optional
        path to the root directory where directory named sourcedata should have
        input files and a directory named derivatives where the outputs would be
        stored, by default '/neurospin/ibc'
    echo_times : str, optional
        JSON file containing echo times for each 12 t2star volumes,
        by default 'qmri_T2star_echo-times.json'
    """
    ...

