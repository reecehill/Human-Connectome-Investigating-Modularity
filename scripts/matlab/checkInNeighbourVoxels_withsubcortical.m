
function output=checkInNeighbourVoxels_withsubcortical(atlas,endpoints)

valsToCheck=[...
    endpoints(1)+1,endpoints(2)+1,endpoints(3)+1;...
    endpoints(1)+1,endpoints(2)+1,endpoints(3)+0;...
    endpoints(1)+1,endpoints(2)+1,endpoints(3)-1;...
    endpoints(1)+1,endpoints(2)+0,endpoints(3)+1;...
    endpoints(1)+1,endpoints(2)+0,endpoints(3)+0;...
    endpoints(1)+1,endpoints(2)+0,endpoints(3)-1;...
    endpoints(1)+1,endpoints(2)-1,endpoints(3)+1;...
    endpoints(1)+1,endpoints(2)-1,endpoints(3)+0;...
    endpoints(1)+1,endpoints(2)-1,endpoints(3)-1;...
    endpoints(1)+0,endpoints(2)+1,endpoints(3)+1;...
    endpoints(1)+0,endpoints(2)+1,endpoints(3)+0;...
    endpoints(1)+0,endpoints(2)+1,endpoints(3)-1;...
    endpoints(1)+0,endpoints(2)+0,endpoints(3)+1;...
%     endpoints(1)+0,endpoints(2)+0,endpoints(3)+0;...
    endpoints(1)+0,endpoints(2)+0,endpoints(3)-1;...
    endpoints(1)+0,endpoints(2)-1,endpoints(3)+1;...
    endpoints(1)+0,endpoints(2)-1,endpoints(3)+0;...
    endpoints(1)+0,endpoints(2)-1,endpoints(3)-1;...
    endpoints(1)-1,endpoints(2)+1,endpoints(3)+1;...
    endpoints(1)-1,endpoints(2)+1,endpoints(3)+0;...
    endpoints(1)-1,endpoints(2)+1,endpoints(3)-1;...
    endpoints(1)-1,endpoints(2)+0,endpoints(3)+1;...
    endpoints(1)-1,endpoints(2)+0,endpoints(3)+0;...
    endpoints(1)-1,endpoints(2)+0,endpoints(3)-1;...
    endpoints(1)-1,endpoints(2)-1,endpoints(3)+1;...
    endpoints(1)-1,endpoints(2)-1,endpoints(3)+0;...
    endpoints(1)-1,endpoints(2)-1,endpoints(3)-1;];
% valsToCheck=[...
%     endpoints(1)+1,endpoints(2)+1,endpoints(3)+1;...
%     endpoints(1)-1,endpoints(2)-1,endpoints(3)-1;];

% MATLAB indices start from 1 only.
valsToCheck(valsToCheck<1)=1;
valsToCheck(valsToCheck>255)=255;
% chk=zeros(26,1);
chk=zeros(26,1);
for i=1:26
    valsToCheck1 = valsToCheck(i,1);
    valsToCheck2 = valsToCheck(i,2);
    valsToCheck3 = valsToCheck(i,3);
   chk(i)=atlas.anatomy(valsToCheck1, valsToCheck2, valsToCheck3);
end

% chk=unique(chk);
chk( ((chk>=7 & chk<=26) | (chk>=47 & chk<=58) | (chk>=1000 & chk<3000)) & chk~=2000 & chk~=14 & chk~=15 & chk~=24 )=nan;
output=+sum(isnan(chk))>0;




end
        